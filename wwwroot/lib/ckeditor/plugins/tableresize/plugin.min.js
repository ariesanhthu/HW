!function(){function O(e){return CKEDITOR.env.ie?e.$.clientWidth:parseInt(e.getComputedStyle("width"),10)}function x(e,t){var t=e.getComputedStyle("border-"+t+"-width"),o={thin:"0px",medium:"1px",thick:"2px"};return t.indexOf("px")<0&&(t=t in o&&"none"!=e.getComputedStyle("border-style")?o[t]:0),parseFloat(t)}function I(e){(e.data||e).preventDefault()}function u(m){function t(){g=0,E.setOpacity(0),v&&function(){for(var r=f.rtl,l=(r?D:y).length,s=0,e=0;e<l;e++){var t=y[e],o=D[e],u=f.table;CKEDITOR.tools.setTimeout(function(e,t,o,n,a,i){e&&e.setStyle("width",K(Math.max(t+i,1))),o&&o.setStyle("width",K(Math.max(n-i,1))),a&&u.setStyle("width",K(a+i*(r?-1:1))),++s==l&&m.fire("saveSnapshot")},0,this,[t,t&&O(t),o,o&&O(o),(!t||!o)&&O(u)+x(u,"left")+x(u,"right"),v])}}();var e=f.table;setTimeout(function(){e.removeCustomData("_cke_table_pillars")},0),T.removeListener("dragstart",I)}function a(e){I(e),m.fire("saveSnapshot"),e=f.index;for(var t=CKEDITOR.tools.buildTableMap(f.table),o=[],n=[],a=Number.MAX_VALUE,i=a,r=f.rtl,l=0,s=t.length;l<s;l++){var u=(d=t[l])[e+(r?1:0)],d=d[e+(r?0:1)],u=u&&new CKEDITOR.dom.element(u),d=d&&new CKEDITOR.dom.element(d);u&&d&&u.equals(d)||(u&&(a=Math.min(a,O(u))),d&&(i=Math.min(i,O(d))),o.push(u),n.push(d))}y=o,D=n,b=f.x-a,C=f.x+i,E.setOpacity(.5),p=parseInt(E.getStyle("left"),10),v=0,g=1,E.on("mousemove",h),T.on("dragstart",I),T.on("mouseup",c,this)}function c(e){e.removeListener(),t()}function h(e){o(e.data.getPageOffset().x)}var f,g,p,v,o,y,D,b,C,T=m.document,E=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10000"></div>',T);m.on("destroy",function(){E.remove()}),i||T.getDocumentElement().append(E),this.attachTo=function(e){var t,o,n;g||(i&&(T.getBody().append(E),v=0),t=(f=e).alignedPillars[0],o=f.alignedPillars[f.alignedPillars.length-1],n=t.y,t=o.height+o.y-t.y,E.setStyles({width:K(e.width),height:K(t),left:K(e.x),top:K(n)}),i&&E.setOpacity(.25),E.on("mousedown",a,this),T.getBody().setStyle("cursor","col-resize"),E.show())},o=this.move=function(e,t){if(!f)return 0;if(!(g||e>=f.x&&e<=f.x+f.width&&t>=f.y&&t<=f.y+f.height))return f=null,g=v=0,T.removeListener("mouseup",c),E.removeListener("mousedown",a),E.removeListener("mousemove",h),T.getBody().setStyle("cursor","auto"),i?E.remove():E.hide(),0;t=e-Math.round(E.$.offsetWidth/2);if(g){if(t==b||t==C)return 1;t=Math.max(t,b),t=Math.min(t,C),v=t-p}return E.setStyle("left",K(t)),1}}function d(e){var t=e.data.getTarget();if("mouseout"==e.name){if(!t.is("table"))return;for(var o=new CKEDITOR.dom.element(e.data.$.relatedTarget||e.data.$.toElement);o&&o.$&&!o.equals(t)&&!o.is("body");)o=o.getParent();if(!o||o.equals(t))return}t.getAscendant("table",1).removeCustomData("_cke_table_pillars"),e.removeListener()}var K=CKEDITOR.tools.cssLength,i=CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks);CKEDITOR.plugins.add("tableresize",{requires:"tabletools",init:function(s){s.on("contentDom",function(){var l,t=s.editable(),e=t.isInline()?t:s.document;t.attachListener(e,"mousemove",function(e){var c,h,f,g,t;if((a=(e=e.data).getTarget()).type==CKEDITOR.NODE_ELEMENT){var o=e.getPageOffset().x,n=e.getPageOffset().y;if(l&&l.move(o,n))I(e);else if((a.is("table")||a.getAscendant({thead:1,tbody:1,tfoot:1},1))&&(e=a.getAscendant("table",1),s.editable().contains(e))){(a=e.getCustomData("_cke_table_pillars"))||(e.setCustomData("_cke_table_pillars",(h=[],f={},g="rtl"===(c=e).getComputedStyle("direction"),t=CKEDITOR.tools.array.zip(new CKEDITOR.dom.nodeList(c.$.rows).toArray(),CKEDITOR.tools.buildTableMap(c)),CKEDITOR.tools.array.forEach(t,function(e){var t=e[0].$,o=(e=e[1],-1),n=0,a=null;a=t?{height:(n=new CKEDITOR.dom.element(t)).$.offsetHeight,position:n.getDocumentPosition()}:void 0;for(var t=CKEDITOR.env.ie&&!CKEDITOR.env.edge,i="collapse"===c.getComputedStyle("border-collapse"),n=a.height,a=a.position,r=0;r<e.length;r++){var l,s,u=new CKEDITOR.dom.element(e[r]),d=e[r+1]&&new CKEDITOR.dom.element(e[r+1]),m=u.getDocumentPosition().x,o=o+(u.$.colSpan||1);g?s=m+x(u,"left"):l=m+u.$.offsetWidth-x(u,"right"),d?(m=d.getDocumentPosition().x,g?l=m+d.$.offsetWidth-x(d,"right"):s=m+x(d,"left")):(m=c.getDocumentPosition().x,g?l=m:s=m+c.$.offsetWidth),u=Math.max(s-l,3),t&&i&&(l-=u,u=Math.max(s-l,3)),u={table:c,index:o,x:l,y:a.y,width:u,height:n,rtl:g},f[o]=f[o]||[],f[o].push(u),u.alignedPillars=f[o],h.push(u)}}),a=h)),e.on("mouseout",d),e.on("mousedown",d));e:{e=a;for(var a=0,i=e.length;a<i;a++){var r=e[a];if(o>=r.x&&o<=r.x+r.width&&n>=r.y&&n<=r.y+r.height){o=r;break e}}o=null}o&&(l=l?l:new u(s)).attachTo(o)}}}),t.attachListener(e,"scroll",function(){var e=t.find("table").toArray();CKEDITOR.tools.array.forEach(e,CKEDITOR.tools.debounce(function(e){e.removeCustomData("_cke_table_pillars")},200))})})}})}();